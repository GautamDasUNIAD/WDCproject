<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management</title>
    <link rel="stylesheet" href="stylesheets/base.css">
    <link rel="stylesheet" href="stylesheets/management.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>

<body>
    <nav id="navbar">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul class="menu">
            <li><a class="active" href="/">LOGO</a></li>
            <li><a href="/events">Events</a></li>
            <li><a href="/branches">Branches</a></li>
        </ul>
        <div class="dropdown" id="organizations-dropdown-div">
            <div class="organizations-dropdown-button">Select an organization...</div>
            <div class="dropdown-content" id="organization-dropdown">
                <!-- Options will be populated dynamically -->
            </div>
        </div>
        <ul>
            <li><a href="/login" class="button2">Login</a></li>
            <li><a href="/signup" class="button3">Signup</a></li>
        </ul>
    </nav>

    <button type="button" id="myBtn" class="accessibility-button">
        <i class="fas fa-eye"></i>
    </button>
    <!-- The Modal -->
    <div id="myModal" class="modal" style = "display:none">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div style="display: flex; align-items: center;">
                <h2 style="margin-right: 100px;">Dark Mode</h2> <label class="switch">
                    <input type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>
    </div>

    <h1 style="padding:20px; text-align:center; font-size: 50px">Management Dashboard</h1>

    <div id="app">
        <div class="button-container">
            <button type="button" @click="showIframe('post-update.html')">Post Update</button>
            <button type="button" @click="showIframe('create-event.html')">Create Event</button>
            <button type="button" @click="showIframe('view-rsvps.html')">View RSVPs</button>
            <button type="button" @click="showIframe('create-branch.html')">Create Branch</button>
            <button type="button" @click="showIframe('manage-users.html')">View Org Members</button>
            <button type="button" @click="showIframe('view-branches.html')">View Branches</button>
        </div>

        <div v-if="currentIframe" class="iframe-container">
            <iframe title="manager-action" :src="currentIframe" width="100%" height="800"></iframe>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="social-media-links">
                <a href="https://www.instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
                <a href="https://www.youtube.com" target="_blank"><i class="fab fa-youtube"></i></a>
                <a href="https://www.tiktok.com" target="_blank"><i class="fab fa-tiktok"></i></a>
            </div>
            <div class="footer-logo">
                <img src="images/logo.png" alt="Company Logo">
            </div>
            <div class="footer-links">
                <a href="/about">About Us</a>
                <a href="/contact">Contact Us</a>
            </div>
        </div>
    </footer>

    <button type="button" id="scrollToTopBtn" title="Go to top">â†‘ Top</button>

    <script src="javascripts/scrollbutton.js"></script>
    <script src="javascripts/homepage_slideshow.js"></script>
    <script src="javascripts/accessibilitybutton.js"></script>
    <script src="javascripts/highcontrast.js"></script>
    <script src="javascripts/vue.js"></script>
    <script src="javascripts/whoami.js"></script>

    <script>
        // Function to retrieve a specific cookie by name
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        // Vue.js instance for managing iframe content
        new Vue({
            el: '#app', // Element ID to mount Vue instance
            data: {
                currentIframe: '' // Holds the current iframe source URL
            },
            methods: {
                // Method to set the current iframe source and handle special cases
                showIframe(iframeSrc) {
                    // Modify iframe source for 'view-rsvps.html' and 'manage-users.html'
                    if (iframeSrc === 'view-rsvps.html' || iframeSrc === 'manage-users.html') {
                        const selectedOrgId = getCookie('selectedOrgId');
                        if (!selectedOrgId) {
                            console.error('No selected organization ID found in cookies.');
                            return;
                        }
                        iframeSrc += `?organizationId=${selectedOrgId}`;
                    }
                    if (iframeSrc === 'view-branches.html') {
                        const selectedOrgId = getCookie('selectedOrgId');
                        if (!selectedOrgId) {
                            console.error('No selected organization ID found in cookies.');
                            return;
                        }
                        iframeSrc += `?organizationId=${selectedOrgId}`;
                    }

                    // Set the current iframe source
                    this.currentIframe = iframeSrc;
                }
            }
        });
    </script>
</body>

</html>
